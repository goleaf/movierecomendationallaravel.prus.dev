select movies.id, movies.title, movies.poster_url, movies.year, movies.type, movies.imdb_rating, movies.imdb_votes, sum(rollups.clicks) as clicks from "rec_trending_rollups" as "rollups" inner join "movies" on "movies"."id" = "rollups"."movie_id" where "rollups"."captured_on" between '2025-02-01' and '2025-02-07' and "movies"."type" = 'movie' and exists (select 1 from json_each("movies"."genres") where "json_each"."value" is 'comedy') and "movies"."year" >= 2020 and "movies"."year" <= 2024 group by "movies"."id", "movies"."title", "movies"."poster_url", "movies"."year", "movies"."type", "movies"."imdb_rating", "movies"."imdb_votes" order by "clicks" desc limit 40
