select "funnels"."placement", "funnels"."impressions", "funnels"."clicks", "funnels"."views" from (select * from (select impressions.placement, impressions.impressions, coalesce(clicks.clicks, 0) as clicks, coalesce(views.views, 0) as views from (select logs.placement, count(*) as impressions from "rec_ab_logs" as "logs" where "logs"."created_at" between '2025-02-01 00:00:00' and '2025-02-07 23:59:59' and "logs"."placement" in ('home', 'trends') group by "logs"."placement") as "impressions" left join (select NULL as placement, 0 as clicks where 1 = 0) as "clicks" on "clicks"."placement" = "impressions"."placement" left join (select NULL as placement, 0 as views where 1 = 0) as "views" on "views"."placement" = "impressions"."placement") union all select * from (select clicks.placement, coalesce(impressions.impressions, 0) as impressions, clicks.clicks, coalesce(views.views, 0) as views from (select NULL as placement, 0 as clicks where 1 = 0) as "clicks" left join (select logs.placement, count(*) as impressions from "rec_ab_logs" as "logs" where "logs"."created_at" between '2025-02-01 00:00:00' and '2025-02-07 23:59:59' and "logs"."placement" in ('home', 'trends') group by "logs"."placement") as "impressions" on "impressions"."placement" = "clicks"."placement" left join (select NULL as placement, 0 as views where 1 = 0) as "views" on "views"."placement" = "clicks"."placement" where "impressions"."placement" is null) union all select * from (select views.placement, coalesce(impressions.impressions, 0) as impressions, coalesce(clicks.clicks, 0) as clicks, views.views from (select NULL as placement, 0 as views where 1 = 0) as "views" left join (select logs.placement, count(*) as impressions from "rec_ab_logs" as "logs" where "logs"."created_at" between '2025-02-01 00:00:00' and '2025-02-07 23:59:59' and "logs"."placement" in ('home', 'trends') group by "logs"."placement") as "impressions" on "impressions"."placement" = "views"."placement" left join (select NULL as placement, 0 as clicks where 1 = 0) as "clicks" on "clicks"."placement" = "views"."placement" where "impressions"."placement" is null and "clicks"."placement" is null)) as "funnels" order by "funnels"."placement" asc
