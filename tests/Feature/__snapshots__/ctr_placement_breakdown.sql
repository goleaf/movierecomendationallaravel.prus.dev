select "placement_breakdown"."placement", "placement_breakdown"."variant", "placement_breakdown"."impressions", "placement_breakdown"."clicks" from (select * from (select impressions.placement, impressions.variant, impressions.impressions, coalesce(clicks.clicks, 0) as clicks from (select logs.placement, logs.variant, count(*) as impressions from "rec_ab_logs" as "logs" where "logs"."created_at" between '2025-02-01 00:00:00' and '2025-02-07 23:59:59' and "logs"."placement" in ('home', 'trends') group by "logs"."placement", "logs"."variant") as "impressions" left join (select clicks.placement, clicks.variant, count(*) as clicks from "rec_clicks" as "clicks" where "clicks"."created_at" between '2025-02-01 00:00:00' and '2025-02-07 23:59:59' and "clicks"."placement" in ('home', 'trends') group by "clicks"."placement", "clicks"."variant") as "clicks" on "clicks"."placement" = "impressions"."placement" and "clicks"."variant" = "impressions"."variant") union all select * from (select clicks.placement, clicks.variant, coalesce(impressions.impressions, 0) as impressions, clicks.clicks from (select clicks.placement, clicks.variant, count(*) as clicks from "rec_clicks" as "clicks" where "clicks"."created_at" between '2025-02-01 00:00:00' and '2025-02-07 23:59:59' and "clicks"."placement" in ('home', 'trends') group by "clicks"."placement", "clicks"."variant") as "clicks" left join (select logs.placement, logs.variant, count(*) as impressions from "rec_ab_logs" as "logs" where "logs"."created_at" between '2025-02-01 00:00:00' and '2025-02-07 23:59:59' and "logs"."placement" in ('home', 'trends') group by "logs"."placement", "logs"."variant") as "impressions" on "impressions"."placement" = "clicks"."placement" and "impressions"."variant" = "clicks"."variant" where "impressions"."placement" is null)) as "placement_breakdown" order by "placement_breakdown"."placement" asc, "placement_breakdown"."variant" asc
