select movies.id, movies.title, movies.poster_url, movies.year, movies.type, movies.imdb_rating, movies.imdb_votes, count(*) as clicks from "rec_clicks" as "clicks" inner join "movies" on "movies"."id" = "clicks"."movie_id" where "clicks"."created_at" between '2025-02-01 00:00:00' and '2025-02-07 23:59:59' and "movies"."type" = 'movie' and exists (select 1 from json_each("movies"."genres") where "json_each"."value" is 'comedy') and "movies"."year" >= 2020 and "movies"."year" <= 2024 group by "movies"."id", "movies"."title", "movies"."poster_url", "movies"."year", "movies"."type", "movies"."imdb_rating", "movies"."imdb_votes" order by "clicks" desc limit 40
