select "daily_metrics"."day", "daily_metrics"."variant", "daily_metrics"."impressions", "daily_metrics"."clicks" from (select * from (select impressions.day, impressions.variant, impressions.impressions, coalesce(clicks.clicks, 0) as clicks from (select date(logs.created_at) as day, logs.variant, count(*) as impressions from "rec_ab_logs" as "logs" where "logs"."created_at" between '2025-02-01 00:00:00' and '2025-02-07 23:59:59' group by date(logs.created_at), logs.variant) as "impressions" left join (select date(clicks.created_at) as day, clicks.variant, count(*) as clicks from "rec_clicks" as "clicks" where "clicks"."created_at" between '2025-02-01 00:00:00' and '2025-02-07 23:59:59' group by date(clicks.created_at), clicks.variant) as "clicks" on "clicks"."day" = "impressions"."day" and "clicks"."variant" = "impressions"."variant") union all select * from (select clicks.day, clicks.variant, coalesce(impressions.impressions, 0) as impressions, clicks.clicks from (select date(clicks.created_at) as day, clicks.variant, count(*) as clicks from "rec_clicks" as "clicks" where "clicks"."created_at" between '2025-02-01 00:00:00' and '2025-02-07 23:59:59' group by date(clicks.created_at), clicks.variant) as "clicks" left join (select date(logs.created_at) as day, logs.variant, count(*) as impressions from "rec_ab_logs" as "logs" where "logs"."created_at" between '2025-02-01 00:00:00' and '2025-02-07 23:59:59' group by date(logs.created_at), logs.variant) as "impressions" on "impressions"."day" = "clicks"."day" and "impressions"."variant" = "clicks"."variant" where "impressions"."day" is null)) as "daily_metrics" order by "daily_metrics"."day" asc, "daily_metrics"."variant" asc
